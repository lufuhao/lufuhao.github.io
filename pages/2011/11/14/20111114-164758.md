---
title: 利用笔记本无线网络实现网络的共享
link: https://lufuhao.wordpress.com/2011/11/14/%e5%88%a9%e7%94%a8%e7%ac%94%e8%ae%b0%e6%9c%ac%e6%97%a0%e7%ba%bf%e7%bd%91%e7%bb%9c%e5%ae%9e%e7%8e%b0%e7%bd%91%e7%bb%9c%e7%9a%84%e5%85%b1%e4%ba%ab/
post_id: 862
created: 2011/11/14 16:47:58
created_gmt: 2011/11/14 07:47:58
comment_status: open
post_name: %e5%88%a9%e7%94%a8%e7%ac%94%e8%ae%b0%e6%9c%ac%e6%97%a0%e7%ba%bf%e7%bd%91%e7%bb%9c%e5%ae%9e%e7%8e%b0%e7%bd%91%e7%bb%9c%e7%9a%84%e5%85%b1%e4%ba%ab
status: publish
post_type: post
---

# 利用笔记本无线网络实现网络的共享

> 2011/11/14 16:47:58

 

虽然通过无线路由器，可以方便将笔记本电脑相互联接，但是如果没有无线路由，只想将两台或三台笔记本通过无线共享文件，那又如何设置呢？最近好多网友询问耗子关于双机无线互联（不采用无线路由器或无线AP）的问题，因此耗子还是按以前的过程，当网友询问过多同一问题时，将此写成文章公布。 

在介绍双机无线互联前，先来了解无线局域网的Ad-Hoc结构。与有线局域网类似，这是一种对等网络结构，各计算机只需安装了无线网卡，彼此即可实现直接互联，无需中间起数据交换作用的AP。同时，该结构中各无线用户的位置是平等的，如不加特殊限制，各用户的操作权限也是相同的。虽同为对等结构，但无线局域网却具备了有线局域网所不可比拟的特定优势。只要有一台计算机建立了点对点连接（相当于虚拟AP），其他多台计算机就可以直接通过这个点对点连接进行网络互联与共享，即无线的直接互联并不局限于两台计算机。这样当联网用户增加时，我们仍可使用无线局域网来满足。 

通过上叙说明，我们也大概了解了。双机无线互联，比有线双机互联，还是麻烦一些，主要是要在一台机器上，建立点对点联接（也可以说虚拟AP），只有这样，两台以上的机器才可通过无线网卡进行无线互联。 

下面，耗子将以两台DELL 630M机器为例做一详细说明，两台机器都安装有XP SP3系统，无线网卡为Intel(R) PRO/Wireless 2200BG Network Connection，并以安装好相应驱动。 

确定两台笔记本已经打开无线，注意是打开，而不仅仅是在网络连接里启动。一般笔记本都有无线网卡打开的组合键，（如DELL 630M，其打开关闭无线网卡的组合键是FN+F2，打开后，无线网卡指示灯亮）。在开始操作前，耗子先说明一下，由于双机无线互联，要有一台机器设置成虚拟AP，因此耗子在这里称为“主机”；另外一台机器称为“副机”。这样说明，可能网友会清楚一些。 

## 一、主机设置 

首先选择一台笔记本，来配置主机（虚拟AP），届时其他无线客户端都将通过该主机来互相访问并建立互联，其作用与AP十分相似。 

在打开“控制面板”--“网络联接”--选择“无线网络连接”属性后，选择“无线网络配置（1）”一项并单击右下角的“高级（2）”按钮，如下图。 

![20111114-164758-0001](/assets/images/20111114-164758-0001.jpg)

在弹出的小对话框中，选择“仅计算机到计算机（特定）（3）”，并且不要勾选“自动连接到非首选网络（4）”，否则当附近有多个“接入点”时，计算机会按照首选网络的排列顺序自动建立连接；选择完成后，点击“关闭”。 

接下来要给这个无线局域网命名，以便其他计算机连接时好区分。这个名字相当于AP中的“SSID标示”，在“虚拟AP”中同样重要。在“无线网络连接属性”中单击“添加（1）”按钮，即可出现“无线网络属性对话框”，如下图所示。这里耗子添加的是“MOUSE（2）”；选择“无线网络密钥”--将“网络身份验证”--设置成开放式（3）；“数据加密”--设置成已禁用（3），设置完成后点击“确定”（4）。 

![20111114-164758-0002](/assets/images/20111114-164758-0002.jpg)

设置完成后，由于采用数据不加密的方式，因此会出现下图显示，在这里，我们选择“仍然继续”。 

![20111114-164758-0003](/assets/images/20111114-164758-0003.gif)

完成后，系统显示已经建好的一个可用联接。 

![20111114-164758-0004](/assets/images/20111114-164758-0004.gif)

设置完成后，点击“无线网络联接”–“常规”–“Internet协议 （TCP/IP）”–“属性”–指定IP地址为“192.168.1.1”掩码：255.255.255.0；其它不需要填写。然后确定退出，自此，主机设置完成。

![20111114-164758-0005](/assets/images/20111114-164758-0005.jpg)

## 二、副机的设置

副机的设置比较简单，打开“控制面板”–“网络联接”–选择“无线网络连接”属性后，选择“无线网络配置（1）”一项并单击右下角的“高级（2）”按钮，

在弹出的小对话框中，选择“仅计算机到计算机（特定）（3）”，并且不要勾选“自动连接到非首选网络（4）”，否则当附近有多个“接入点”时，计算机会按照首选网络的排列顺序自动建立连接；选择完成后，点击“关闭”。 

![20111114-164758-0006](/assets/images/20111114-164758-0006.jpg)

设置完成后，点击“无线网络联接”–“常规”–“Internet协议 （TCP/IP）”–“属性”–将IP地址和DNS地址全部选为自动获取，确定即可（如下图）。

主机和副机设置完成后，在副机上双击“无线网络联接”，正常应显示出我们做好的联接（如果没有检测到，可点击“刷新网络列表”），此时，只要点击联接，应可正常联接的，（如下图）

已经联接上的图如下： 

![20111114-164758-0007](/assets/images/20111114-164758-0007.jpg)

如果有两台以上的机器无线互联，那么其它机器，都按副机的设置过程设置即可。这样两台 三台 四台…….笔记本，都可通过无线网卡进行互联了。

新加win7 方法

具体方法如下：

win7下通过自己的无线网络和朋友分享网络连接，或者说是只是朋友之间相互连接一下，组建成一个小型局域网，有以下两种方法：

### 方法一：

打开网络共享中心，选择“设置新的连或接网络” 

![20111114-164758-0008](/assets/images/20111114-164758-0008.jpg)

再选择设置无线临时网络

![20111114-164758-0009](/assets/images/20111114-164758-0009.jpg)

![20111114-164758-0010](/assets/images/20111114-164758-0010.jpg)

![20111114-164758-0011](/assets/images/20111114-164758-0011.jpg)

这些自己确定了，不过密码必须是8位以上的字母或数字组成，如果密码类型选wep,个数只有两种情况可供选择，会有提示的。 

![20111114-164758-0012](/assets/images/20111114-164758-0012.jpg)

![20111114-164758-0013](/assets/images/20111114-164758-0013.jpg)

如果是第一次，应该还会出现“启用网络共享”这一项，点击共享就行了。这里没有了，因为我已经把本地连接共享给方法二里的网络了。如果不启用共享，别人连上你的是不能上网的，会显示无Internet访问。 

![20111114-164758-0014](/assets/images/20111114-164758-0014.jpg)

至此，无线网络已经创建完成，也已经连接上，显示等待用户，这时，在你朋友的无线搜索里会显示出这个无线点来，点击连接，输入刚才的密钥即可。

顺顺便提一下，以后每次要连接，你这边必须要先点击连接，然后别人那里才能搜索到你哦。

### 方法二：（本人正在用的方法）

就是win7的虚拟基站功能，将一台能上网的电脑（当然得有无线网卡了，而且目前还仅限一些特定型号）虚拟成一个无线基站，共享网络连接。

其实也只是简单的两条命令而已：

以管理员身份运行命令提示符，输入以下两条命令：

> netsh wlan set hostednetwork mode=allow ssid=shines key=happy***

（该命令设置ssid为shines,密码为happy***，连接模式为允许的承载网络，密码须大于等于8位，否则不成功）

如果网卡支持，在网络连接里会发现多了一项无线连接，并且名为Microsoft Virtual WiFi Mini Port Adapter,如下图： 

![20111114-164758-0015](/assets/images/20111114-164758-0015.jpg)

将本地连接（当然是能上网的那个）共享给此连接：

![20111114-164758-0016](/assets/images/20111114-164758-0016.jpg)

![20111114-164758-0017](/assets/images/20111114-164758-0017.jpg)

点击是，确定共享。

> netsh wlan start hostednetwork

（很明显了，启动承载网络）

如下图： 

![20111114-164758-0018](/assets/images/20111114-164758-0018.jpg)

这时再看你的网络连接，是不是多了一项shines,并且有Internet访问权限，这样别人就能搜索到这个虚拟基站，点击连接，输入相应密码即可共享你的网络来上网了。 

![20111114-164758-0019](/assets/images/20111114-164758-0019.jpg)

这种方法自我感觉比较酷，呵呵，虚拟出了一个无线站点出来。不过每次开机这个站点并不会自动启动，还须手工启动，就是如上所说以管理员身份在命令提示符里再次运行 netsh wlan start hostednetwork。

不过我采取的办法是建立一个批处理文件，用记事本输入以下内容：netsh wlan start hostednetwork,另存为“打开虚拟基站.bat”,不过还有一个问题，就是此命令只有管理员权限才能正常运行，每次点右键“以管理员身份运行”又有些麻烦，于是便发送该文件的快捷方式到桌面，在快捷方式属性里点高级，以管理员身份运行，这样需要的时候直接单击就可以了……当然也可以把这个快捷方式拖进开始菜单的启动文件夹里，或者以开机脚本的方式运行，都能在启动时自动运行，当然还得看你需不需要了。
